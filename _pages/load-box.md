---
ID: 324
post_title: Load Geometry
author: davm
post_date: 2016-06-27 06:14:00
post_excerpt: ""
layout: page
permalink: >
  http://localhost/wordpress/tutorials/load-box/
published: true
panels_data:
  - |
    a:3:{s:7:"widgets";a:5:{i:0;a:4:{s:5:"title";s:0:"";s:4:"text";s:255:"In the following tutorials we will show you, how to create, import and display cool models and bring them to the Data Arena.
    
    Graphics programming experience is not a prerequisite, although it will help to have some understanding of the graphics pipeline.";s:6:"filter";b:0;s:11:"panels_info";a:7:{s:5:"class";s:14:"WP_Widget_Text";s:3:"raw";b:0;s:4:"grid";i:0;s:4:"cell";i:0;s:2:"id";i:0;s:9:"widget_id";s:36:"8458d952-2849-47ac-8244-b11bcc3949d1";s:5:"style";a:1:{s:18:"background_display";s:4:"tile";}}}i:1;a:6:{s:5:"title";s:0:"";s:4:"text";s:983:"<h4>Technology stack</h4><p>(maybe make a diagram of technology stack here?)</p><p>The Data Arena synchronizes its displays using a library called Equalizer to replicate low-level graphics commands over a network. However you will most probably not have to interact with it. The user builds graphical applications by using omegalib (insert link), cyclops and/or OpenSceneGraph. Omegalib is middleware designed to ease the development of applications for virtual reality (VR) and immersive display environments and can integrate a variety of other frameworks. We use OpenSceneGraph (insert link), a powerful graphics rendering library, to render our graphics.</p><p>However, OpenSceneGraph is also a fairly complex library with a steep learning curve. Therefore, cyclops (insert link), a high-level API for osg is used to do common graphic operations in the Data Arena. The Data Arena also provides custom classes to handle standard use-cases and to ease the first steps.</p><p>Â </p>";s:20:"text_selected_editor";s:4:"tmce";s:5:"autop";b:1;s:12:"_sow_form_id";s:13:"5771c634a985b";s:11:"panels_info";a:7:{s:5:"class";s:31:"SiteOrigin_Widget_Editor_Widget";s:3:"raw";b:0;s:4:"grid";i:1;s:4:"cell";i:0;s:2:"id";i:1;s:9:"widget_id";s:36:"1391920e-3d6d-43e3-a359-05f94389c1e0";s:5:"style";a:1:{s:18:"background_display";s:4:"tile";}}}i:2;a:13:{s:5:"image";i:392;s:14:"image_fallback";s:0:"";s:4:"size";s:4:"full";s:5:"align";s:7:"default";s:5:"title";s:0:"";s:14:"title_position";s:6:"hidden";s:3:"alt";s:0:"";s:3:"url";s:0:"";s:5:"bound";b:1;s:12:"_sow_form_id";s:13:"5771ca398cf62";s:10:"new_window";b:0;s:10:"full_width";b:0;s:11:"panels_info";a:7:{s:5:"class";s:30:"SiteOrigin_Widget_Image_Widget";s:3:"raw";b:0;s:4:"grid";i:1;s:4:"cell";i:1;s:2:"id";i:2;s:9:"widget_id";s:36:"9a9a63cf-976e-40c5-be98-63c4b0bc425e";s:5:"style";a:2:{s:7:"padding";s:4:"20px";s:18:"background_display";s:4:"tile";}}}i:3;a:4:{s:5:"title";s:0:"";s:4:"text";s:374:"<h4> Getting Started </h4>
    
    The Data Arena VM comes with all the software needed to display things in the Data Arena.
    For this tutorial, we will mostly interact with scripts inside the "/local/examples/" folder, which contains the examples of this tutorial(s) and the custom handlers (in the pipelines folder).
    
    So lets get started and build our first immersive application!";s:6:"filter";b:0;s:11:"panels_info";a:7:{s:5:"class";s:14:"WP_Widget_Text";s:3:"raw";b:0;s:4:"grid";i:2;s:4:"cell";i:0;s:2:"id";i:3;s:9:"widget_id";s:36:"8458d952-2849-47ac-8244-b11bcc3949d1";s:5:"style";a:1:{s:18:"background_display";s:4:"tile";}}}i:4;a:6:{s:5:"title";s:0:"";s:4:"text";s:6196:"<h4>Cube Tutorial</h4><p>The hello world program of the graphics world is displaying a simple object, such as a cube. Before being able to display anything, you have to have a model of a cube first, of course. Creating and exporting models will be covered in the next tutorial, for now, take the "box.obj" model from the "examples/box" folder. Wavefront (.obj) models are a popular format for exchanging 3d models between different applications. They contain the definition of the geometry, colors and many optional definitions. Fortunately, we don't have to parse this model by ourselves but can use a model loader, which is part of the osg package. The "Geometry" class takes care of loading the model and adding it to the scenegraph (more on that later).</p><p>The following is a minimal working example:</p><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'/local/examples'</span><span class="p">)</span>
    
    <span class="kn">from</span> <span class="nn">pipelines.objects</span> <span class="kn">import</span> <span class="n">Geometry</span>
    <span class="kn">from</span> <span class="nn">pipelines.handler</span> <span class="kn">import</span> <span class="n">GeometryHandler</span> 
    
    <span class="n">fileToLoad</span> <span class="o">=</span> <span class="s2">"/local/examples/box/box.obj"</span>
    
    <span class="n">geo</span> <span class="o">=</span> <span class="n">Geometry</span><span class="p">(</span><span class="n">fileToLoad</span><span class="p">)</span>
    
    <span class="n">handler</span> <span class="o">=</span> <span class="n">GeometryHandler</span><span class="p">()</span>
    <span class="n">handler</span><span class="o">.</span><span class="n">initialCamPosition</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
    <span class="n">handler</span><span class="o">.</span><span class="n">addGeo</span><span class="p">(</span><span class="n">geo</span><span class="p">)</span>
    </pre></div><p>The code above adds the examples folder to the system path, so the pipelines are importable.<br /> Then, by creating an Geometry object and giving it the path to the model, the box.obj model is loaded, added to the scene and its material is set. Have a look at "objects.py" (link to geometry docs or source), to see what exactly is going on.</p><p>Then a GeometryHandler is instanced and the geometry is registered with the addGeo() method. This step ensures, that the camera is focused on the center of the model. Before adding geometry, set the initial camera position to have a higher z value, so the camera looks from above onto the object and is not too close.</p><p>(embed box1 image)</p><p><img class="alignnone size-medium wp-image-562" src="http://localhost/wordpress/wp-content/uploads/2016/06/box1-300x169.png" alt="box1" width="300" height="169" /></p><p>To add another box to the scene, you can load the box in a new Geometry, set its initial position to a different position and register it to the GeometryHandler. Also set the initial camera position to the middle of both cubes.</p><div class="highlight"><pre><span class="c1">#update the initial camera position</span>
    <span class="n">handler</span><span class="o">.</span><span class="n">initialCamPosition</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> 
    <span class="c1">#add new box</span>
    <span class="n">geo2</span> <span class="o">=</span> <span class="n">Geometry</span><span class="p">(</span><span class="n">fileToLoad</span><span class="p">)</span>
    <span class="n">geo2</span><span class="o">.</span><span class="n">initialPosition</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">handler</span><span class="o">.</span><span class="n">addGeo</span><span class="p">(</span><span class="n">geo2</span><span class="p">)</span>
    </pre></div><p>(embed box2 image)</p><p><img class="alignnone size-medium wp-image-563" src="http://localhost/wordpress/wp-content/uploads/2016/06/box2-300x170.png" alt="box2" width="300" height="170" /></p><p>Now both boxes are displayed, but we can't interact with them yet. The GeometryHandler class contains configurable interaction handlers, which let you control the model using different input devices (mouse, ps4 controller, space navigator). To use the event handlers, they have to be registered in omegalib.</p><div class="highlight"><pre><span class="n">setEventFunction</span><span class="p">(</span><span class="n">handler</span><span class="o">.</span><span class="n">onEvent</span><span class="p">)</span>
    <span class="n">setUpdateFunction</span><span class="p">(</span><span class="n">handler</span><span class="o">.</span><span class="n">onUpdate</span><span class="p">)</span>
    </pre></div><p>The setEventFunction (add link) passes through all input events to the handler's onEvent function, the setUpdateFunction (add link) registers a script function to be called before each frame is rendered.<br /> Now the boxes can be rotate in the scene. The interaction handler provides several ways to constrain the movement of the camera and of the object, which are displayed in the console.<br /> When pressing "m", the mode can be toggled between object mode to camera mode. You can use object mode to rotate and translate the object and camera mode to orient yourself in the space in a first person way.</p><p>(embed box3 image)</p><p><img class="alignnone size-medium wp-image-564" src="http://localhost/wordpress/wp-content/uploads/2016/06/box3-300x168.png" alt="box3" width="300" height="168" /></p><p>In the next tutorial, you will learn how to apply simple materials to objects.</p>";s:20:"text_selected_editor";s:4:"tmce";s:5:"autop";b:1;s:12:"_sow_form_id";s:13:"5770c532d1e3d";s:11:"panels_info";a:7:{s:5:"class";s:31:"SiteOrigin_Widget_Editor_Widget";s:3:"raw";b:0;s:4:"grid";i:2;s:4:"cell";i:0;s:2:"id";i:4;s:9:"widget_id";s:36:"1391920e-3d6d-43e3-a359-05f94389c1e0";s:5:"style";a:1:{s:18:"background_display";s:4:"tile";}}}}s:5:"grids";a:3:{i:0;a:2:{s:5:"cells";i:1;s:5:"style";a:4:{s:7:"padding";s:4:"10px";s:5:"align";s:0:"";s:16:"background_image";b:0;s:14:"column_padding";s:0:"";}}i:1;a:2:{s:5:"cells";i:2;s:5:"style";a:4:{s:7:"padding";s:3:"0px";s:5:"align";s:0:"";s:16:"background_image";b:0;s:14:"column_padding";s:0:"";}}i:2;a:2:{s:5:"cells";i:1;s:5:"style";a:4:{s:7:"padding";s:4:"20px";s:5:"align";s:0:"";s:16:"background_image";b:0;s:14:"column_padding";s:0:"";}}}s:10:"grid_cells";a:4:{i:0;a:2:{s:4:"grid";i:0;s:6:"weight";i:1;}i:1;a:2:{s:4:"grid";i:1;s:6:"weight";d:0.5;}i:2;a:2:{s:4:"grid";i:1;s:6:"weight";d:0.5;}i:3;a:2:{s:4:"grid";i:2;s:6:"weight";i:1;}}}
---
In the following tutorials we will show you, how to create, import and display cool models and bring them to the Data Arena. Graphics programming experience is not a prerequisite, although it will help to have some understanding of the graphics pipeline.
<h4>Technology stack</h4>
(maybe make a diagram of technology stack here?)

The Data Arena synchronizes its displays using a library called Equalizer to replicate low-level graphics commands over a network. However you will most probably not have to interact with it. The user builds graphical applications by using omegalib (insert link), cyclops and/or OpenSceneGraph. Omegalib is middleware designed to ease the development of applications for virtual reality (VR) and immersive display environments and can integrate a variety of other frameworks. We use OpenSceneGraph (insert link), a powerful graphics rendering library, to render our graphics.

However, OpenSceneGraph is also a fairly complex library with a steep learning curve. Therefore, cyclops (insert link), a high-level API for osg is used to do common graphic operations in the Data Arena. The Data Arena also provides custom classes to handle standard use-cases and to ease the first steps.

&nbsp;

<img class="so-widget-image" src="http://localhost/wordpress/wp-content/uploads/2016/06/placeholder.jpg" srcset="http://localhost/wordpress/wp-content/uploads/2016/06/placeholder.jpg 498w, http://localhost/wordpress/wp-content/uploads/2016/06/placeholder-300x221.jpg 300w, http://localhost/wordpress/wp-content/uploads/2016/06/placeholder-230x169.jpg 230w, http://localhost/wordpress/wp-content/uploads/2016/06/placeholder-350x258.jpg 350w, http://localhost/wordpress/wp-content/uploads/2016/06/placeholder-480x354.jpg 480w" width="498" height="367" />
<h4>Getting Started</h4>
The Data Arena VM comes with all the software needed to display things in the Data Arena. For this tutorial, we will mostly interact with scripts inside the "/local/examples/" folder, which contains the examples of this tutorial(s) and the custom handlers (in the pipelines folder). So lets get started and build our first immersive application!
<h4>Cube Tutorial</h4>
The hello world program of the graphics world is displaying a simple object, such as a cube. Before being able to display anything, you have to have a model of a cube first, of course. Creating and exporting models will be covered in the next tutorial, for now, take the "box.obj" model from the "examples/box" folder. Wavefront (.obj) models are a popular format for exchanging 3d models between different applications. They contain the definition of the geometry, colors and many optional definitions. Fortunately, we don't have to parse this model by ourselves but can use a model loader, which is part of the osg package. The "Geometry" class takes care of loading the model and adding it to the scenegraph (more on that later).

The following is a minimal working example:
<pre><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'/local/examples'</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pipelines.objects</span> <span class="kn">import</span> <span class="n">Geometry</span>
<span class="kn">from</span> <span class="nn">pipelines.handler</span> <span class="kn">import</span> <span class="n">GeometryHandler</span> 
<span class="n">fileToLoad</span> <span class="o">=</span> <span class="s2">"/local/examples/box/box.obj"</span>
<span class="n">geo</span> <span class="o">=</span> <span class="n">Geometry</span><span class="p">(</span><span class="n">fileToLoad</span><span class="p">)</span>
<span class="n">handler</span> <span class="o">=</span> <span class="n">GeometryHandler</span><span class="p">()</span>
<span class="n">handler</span><span class="o">.</span><span class="n">initialCamPosition</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">handler</span><span class="o">.</span><span class="n">addGeo</span><span class="p">(</span><span class="n">geo</span><span class="p">)</span>
</pre>
The code above adds the examples folder to the system path, so the pipelines are importable.
Then, by creating an Geometry object and giving it the path to the model, the box.obj model is loaded, added to the scene and its material is set. Have a look at "objects.py" (link to geometry docs or source), to see what exactly is going on.

Then a GeometryHandler is instanced and the geometry is registered with the addGeo() method. This step ensures, that the camera is focused on the center of the model. Before adding geometry, set the initial camera position to have a higher z value, so the camera looks from above onto the object and is not too close.

(embed box1 image)

<img class="alignnone size-medium wp-image-562" src="http://localhost/wordpress/wp-content/uploads/2016/06/box1-300x169.png" sizes="(max-width: 300px) 100vw, 300px" srcset="http://localhost/wordpress/wp-content/uploads/2016/06/box1-300x169.png 300w, http://localhost/wordpress/wp-content/uploads/2016/06/box1-768x432.png 768w, http://localhost/wordpress/wp-content/uploads/2016/06/box1-830x467.png 830w, http://localhost/wordpress/wp-content/uploads/2016/06/box1-230x129.png 230w, http://localhost/wordpress/wp-content/uploads/2016/06/box1-350x197.png 350w, http://localhost/wordpress/wp-content/uploads/2016/06/box1-480x270.png 480w, http://localhost/wordpress/wp-content/uploads/2016/06/box1.png 854w" alt="box1" width="300" height="169" />

To add another box to the scene, you can load the box in a new Geometry, set its initial position to a different position and register it to the GeometryHandler. Also set the initial camera position to the middle of both cubes.
<pre><span class="c1">#update the initial camera position</span>
<span class="n">handler</span><span class="o">.</span><span class="n">initialCamPosition</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> 
<span class="c1">#add new box</span>
<span class="n">geo2</span> <span class="o">=</span> <span class="n">Geometry</span><span class="p">(</span><span class="n">fileToLoad</span><span class="p">)</span>
<span class="n">geo2</span><span class="o">.</span><span class="n">initialPosition</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">handler</span><span class="o">.</span><span class="n">addGeo</span><span class="p">(</span><span class="n">geo2</span><span class="p">)</span>
</pre>
(embed box2 image)

<img class="alignnone size-medium wp-image-563" src="http://localhost/wordpress/wp-content/uploads/2016/06/box2-300x170.png" sizes="(max-width: 300px) 100vw, 300px" srcset="http://localhost/wordpress/wp-content/uploads/2016/06/box2-300x170.png 300w, http://localhost/wordpress/wp-content/uploads/2016/06/box2-768x434.png 768w, http://localhost/wordpress/wp-content/uploads/2016/06/box2-830x469.png 830w, http://localhost/wordpress/wp-content/uploads/2016/06/box2-230x130.png 230w, http://localhost/wordpress/wp-content/uploads/2016/06/box2-350x198.png 350w, http://localhost/wordpress/wp-content/uploads/2016/06/box2-480x271.png 480w, http://localhost/wordpress/wp-content/uploads/2016/06/box2.png 849w" alt="box2" width="300" height="170" />

Now both boxes are displayed, but we can't interact with them yet. The GeometryHandler class contains configurable interaction handlers, which let you control the model using different input devices (mouse, ps4 controller, space navigator). To use the event handlers, they have to be registered in omegalib.
<pre><span class="n">setEventFunction</span><span class="p">(</span><span class="n">handler</span><span class="o">.</span><span class="n">onEvent</span><span class="p">)</span>
<span class="n">setUpdateFunction</span><span class="p">(</span><span class="n">handler</span><span class="o">.</span><span class="n">onUpdate</span><span class="p">)</span>
</pre>
The setEventFunction (add link) passes through all input events to the handler's onEvent function, the setUpdateFunction (add link) registers a script function to be called before each frame is rendered.
Now the boxes can be rotate in the scene. The interaction handler provides several ways to constrain the movement of the camera and of the object, which are displayed in the console.
When pressing "m", the mode can be toggled between object mode to camera mode. You can use object mode to rotate and translate the object and camera mode to orient yourself in the space in a first person way.

(embed box3 image)

<img class="alignnone size-medium wp-image-564" src="http://localhost/wordpress/wp-content/uploads/2016/06/box3-300x168.png" sizes="(max-width: 300px) 100vw, 300px" srcset="http://localhost/wordpress/wp-content/uploads/2016/06/box3-300x168.png 300w, http://localhost/wordpress/wp-content/uploads/2016/06/box3-768x431.png 768w, http://localhost/wordpress/wp-content/uploads/2016/06/box3-830x466.png 830w, http://localhost/wordpress/wp-content/uploads/2016/06/box3-230x129.png 230w, http://localhost/wordpress/wp-content/uploads/2016/06/box3-350x196.png 350w, http://localhost/wordpress/wp-content/uploads/2016/06/box3-480x269.png 480w, http://localhost/wordpress/wp-content/uploads/2016/06/box3.png 850w" alt="box3" width="300" height="168" />

In the next tutorial, you will learn how to apply simple materials to objects.